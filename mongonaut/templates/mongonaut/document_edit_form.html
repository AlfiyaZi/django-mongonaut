{% extends "mongonaut/base.html" %}
{% load mongonaut_tags %}

{% block breadcrumbs %}
<li><a href="{% url index %}">Mongonaut</a> <span class="divider">/</span></li>
<li><a href="{% url document_list app_label document_name %}">{{ document_name }}s</a> <span class="divider">/</span></li>
<li><a href="{% url document_detail app_label document_name document.id %}">{{ document_name }} {{ document.id }}</a> <span class="divider">/</span></li>
<li><a href="">Edit</a>
{% endblock %}

{% block content %}

<h1>{{ document_name }} Detail Edit</h1>

<form method="POST" action="">
<div class="row">
    <div class="span12">
        {% csrf_token %}
        <fieldset>
            {% for field in form %}
                {% include "mongonaut/includes/_field.html" %}
            {% endfor %}
        </fieldset>
    </div>
</div>  
<div class="row">
    <div class="span6">      
        <div class="btn-group">
            <input type="submit" name="action" class="btn btn-primary" value="Save">

            <input type="submit" name="action" class="btn btn-disabled" readonly value="Save and continue editing">
            <input type="submit" name="action" class="btn btn-disabled" readonly value="Save and add another">
            <a href="#" id="action_delete" class="btn btn-danger{% if not has_delete_permission %} disabled{%endif%}" {% if not has_delete_permission %}readonly{% endif %}>X Delete</a>

        </div>     
        <div class="alert alert-block alert-error fade in" style="display: none;" id="delete_warning">
                    <a class="close alert_close" href="#">Ã—</a>
                    <h4 class="alert-heading">Are you sure you want to delete this document?</h4>
                    <p>Once you delete this document you can't recover it. It's gone forever!</p>
                    <p>
                        <a class="btn btn-success small alert_close" href="#">Cancel</a>
                        <a class="btn btn-danger" id="action_delete_ok" href="#">Delete forever!</a> 
                    </p>
        </div> 
    </div>        
</div>
</form>        
  

{% endblock %}

{% block extrajs %}
<form method="post" id="delete_form" action="{% url document_delete app_label document_name document.id %}">
{% csrf_token %}
</form>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-alert.js" type="text/javascript"></script>

<script type="text/javascript">
    $("#action_delete").click(function(){
        $('.btn-group').hide();
        $('#delete_warning').show();   
    });        
    $(".alert_close").click(function(){
        $('.btn-group').show();
        $('#delete_warning').hide();  
    });
    $("#action_delete_ok").click(function(){
        var form_ = $('#delete_form');
        form_.submit();
    });
</script>

{% endblock %}
